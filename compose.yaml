# Docker Compose Development Configuration
# Local development: access via http://localhost
# Server works on port 8000 inside container (same as production)

services:
  server:
    build:
      context: .
      target: development
    ports:
      - "80:8000"    # Local access via port 80 â†’ container port 8000
    volumes:
      - .:/app                        # Mount source code for live reload
      - go-modules:/go/pkg/mod        # Cache Go modules
      - /app/tmp                      # Exclude Air build directory
    restart: unless-stopped

volumes:
  go-modules:    # Cache Go modules across container rebuilds

# Uncomment below to add PostgreSQL database
#   db:
#     image: postgres:16-alpine
#     restart: always
#     environment:
#       - POSTGRES_DB=judo_archive
#       - POSTGRES_USER=judo
#       - POSTGRES_PASSWORD=judo_password
#     volumes:
#       - db-data:/var/lib/postgresql/data
#     ports:
#       - 5432:5432
#     healthcheck:
#       test: ["CMD", "pg_isready", "-U", "judo"]
#       interval: 10s
#       timeout: 5s
#       retries: 5
#
# volumes:
#   go-modules:
#   db-data:

